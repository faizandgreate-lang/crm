<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MFK Riyadh Accommodation</title>
<style>
  body { font-family: "Poppins", Arial,sans-serif; margin:20px; background:#fff; color:#000; }
  h1, h2 { text-align:center; margin-bottom:15px; }
  table{border-collapse:collapse;width:100%;margin:15px 0;background:#fff;border:1px solid #000;}
  th,td{border:1px solid #000;padding:8px 10px;text-align:left;font-size:14px;}
  th{background:#000;color:#fff;text-transform:uppercase;}
  tr:nth-child(even){background:#f0f0f0;}
  .summary-chart { display:flex; gap:20px; flex-wrap:wrap; align-items:flex-start; justify-content:center; }
  .summary-chart > .box { flex:1; min-width:300px; background:transparent; padding:10px; }
  .breathing-logo { animation: breathe 2s ease-in-out infinite; height:90px; width:auto; }
  @keyframes breathe { 0%,100%{transform:scale(1);}50%{transform:scale(1.05);} }
  .footer{text-align:center;margin-top:30px;color:#555;font-style:italic;}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<!-- Loading Screen -->
<div id="loadingScreen" style="
  position:fixed; top:0; left:0; width:100%; height:100%;
  background:#fff; display:flex; justify-content:center; align-items:center;
  z-index:9999; flex-direction:column;">
  <img src="https://i.ibb.co/7d19gQ0h/logo.png" class="breathing-logo" alt="Loading Logo" style="max-height:120px; margin-bottom:15px;">
  <p style="font-size:18px; font-weight:600;">Loading...</p>
</div>

<h1>MFK ACCOMMODATION</h1>

<!-- Logo -->
<div style="text-align:center; margin-bottom:20px;">
  <img src="https://i.ibb.co/7d19gQ0h/logo.png" class="breathing-logo" alt="MFK Logo" style="max-height:100px;">
</div>

<!-- Charts -->
<div class="summary-chart">
  <div class="box">
    <h2>Workers per Company</h2>
    <canvas id="companyChart" height="300"></canvas>
  </div>
  <div class="box">
    <h2>Workers per Camp</h2>
    <canvas id="campChart" height="300"></canvas>
  </div>
</div>

<!-- Worker Table -->
<h2>Worker Details</h2>
<div id="tableWrap"></div>

<div class="footer">Made with ❤️ by <span>Faizan Khan</span></div>

<script>
// Hide loading screen
window.addEventListener("load", () => {
  document.getElementById("loadingScreen").style.display = "none";
  generateWorkers();
  generateTable();
  updateCharts();
  setInterval(updateCharts, 3000); // Update charts every 3 sec
});

// Sample data
const companies = ["I.R.C", "Rexus", "Galleria", "MFK Hospitality"];
const camps = ["New Bawadi", "G. Bawadi", "Old Rabwa", "B. Sultan"];
let workers = [];

// Generate 100 random workers
function generateWorkers() {
  workers = [];
  for(let i=1;i<=100;i++){
    workers.push({
      iq:"IQ"+(1000+i),
      name:"Worker "+i,
      company:companies[Math.floor(Math.random()*companies.length)],
      camp:camps[Math.floor(Math.random()*camps.length)]
    });
  }
}

// Generate worker table
function generateTable() {
  let html="<table><tr><th>IQAMA</th><th>Name</th><th>Company</th><th>Camp</th></tr>";
  workers.forEach(w=>{
    html+=`<tr><td>${w.iq}</td><td>${w.name}</td><td>${w.company}</td><td>${w.camp}</td></tr>`;
  });
  html+="</table>";
  document.getElementById("tableWrap").innerHTML = html;
}

// Initialize charts
let companyChart, campChart;
function updateCharts() {
  const companySummary = {};
  const campSummary = {};
  companies.forEach(c=>companySummary[c]=0);
  camps.forEach(c=>campSummary[c]=0);
  workers.forEach(w=>{
    companySummary[w.company]++;
    campSummary[w.camp]++;
  });

  const companyData = { labels:Object.keys(companySummary), datasets:[{label:'Workers', data:Object.values(companySummary), backgroundColor:['#000','#555','#999','#222']}]};
  const campData = { labels:Object.keys(campSummary), datasets:[{label:'Workers', data:Object.values(campSummary), backgroundColor:['#000','#555','#999','#222']}]};

  if(companyChart){
    companyChart.data.datasets[0].data = companyData.datasets[0].data;
    companyChart.update();
  } else {
    const ctx = document.getElementById('companyChart').getContext('2d');
    companyChart = new Chart(ctx,{type:'bar',data:companyData, options:{responsive:true,plugins:{legend:{display:false}}}});
  }

  if(campChart){
    campChart.data.datasets[0].data = campData.datasets[0].data;
    campChart.update();
  } else {
    const ctx = document.getElementById('campChart').getContext('2d');
    campChart = new Chart(ctx,{type:'bar',data:campData, options:{responsive:true,plugins:{legend:{display:false}}}});
  }
}
</script>
</body>
</html>
